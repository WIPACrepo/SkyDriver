{
    "apiVersion": "batch/v1",
    "kind": "Job",
    "metadata": {
      "name": "X",
      "namespace": "X"
    },
    "spec": {
      "completions": 200,
      "parallelism": 200,
      "ttlSecondsAfterFinished": 7200,
      "template": {
        "spec": {
          "serviceAccountName": "X",
          "restartPolicy": "OnFailure",
          "tolerations": [
            {
              "effect": "NoSchedule",
              "key": "kubernetes.io/arch",
              "operator": "Exists"
            }
          ],
          "initContainers": [
            {
              "name": "skydriver-get-startup-config",
              "env": [
                {
                  "name": "URL_EVENT_STARTUP_JSON",
                  "value": "X"
                }
              ],
              "image": "busybox",
              "command": [
                "wget", 
                "-O",
                "/skymap-scanner-startup-config/startup.json",
                "$(URL_EVENT_STARTUP_JSON)"
              ],
              "volumeMounts": [
                {
                  "name": "startup-config-mount",
                  "mountPath": "/skymap-scanner-startup-config"
                }
              ]
            }
          ],
          "containers": [
            {
              "env": [
                {
                  "name": "SKYDRIVER_TOKEN",
                  "valueFrom": {
                    "secretKeyRef": {
                      "name": "pulsar-300-token-admin",
                      "key": "TOKEN"
                    }
                  }
                },
                {
                  "name": "SKYSCAN_BROKER_ADDRESS",
                  "value": "34.72.37.204"
                },
                {
                  "name": "I3_TESTDATA",
                  "value": "/cvmfs/icecube.opensciencegrid.org/data/i3-test-data-svn/trunk"
                },
                {
                  "name": "I3_DATA",
                  "value": "/cvmfs/icecube.opensciencegrid.org/data"
                },
                {
                  "name": "EWMS_PILOT_TASK_TIMEOUT",
                  "value": "600"
                }
              ],
              "image": "icecube/skymap_scanner:X.Y.Z",
              "imagePullPolicy": "Always",
              "name": "skydriver-worker",
              "command": [
                "/bin/bash",
                "/usr/local/icetray/env-shell.sh"
              ],
              "args": [
                "python",
                "-m",
                "skymap_scanner.client",
                "--startup-json-dir",
                "/skymap-scanner-startup-config/",
                "--broker",
                "$(SKYDRIVER_MQ_SERVER)",
                "--auth-token",
                "$(SKYDRIVER_TOKEN)"
              ],
              "resources": "X",
              "volumeMounts": [
                {
                  "mountPath": "/skymap-scanner-startup-config/",
                  "name": "startup-config-mount",
                  "readOnly": true
                },
                {
                  "mountPath": "/dev/shm",
                  "name": "dshm"
                },
                {
                  "mountPath": "/cvmfs/icecube.opensciencegrid.org/data/photon-tables/splines/",
                  "name": "spline-table-vol"
                }
              ]
            }
          ],
          "volumes": [
            {
              "name": "startup-config-mount",
              "emptyDir": {}
            },
            {
              "name": "spline-table-vol",
              "emptyDir": {}
            },
            {
              "name": "dshm",
              "emptyDir": {
                "medium": "Memory"
              }
            }
          ]
        }
      }
    }
  }